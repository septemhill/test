langulage: go

services:
  - docker

before_install:
  - docker pull postgres:13
  - docker pull septemhill/liquibase:latest
  - docker run -p 5432:5432 -e POSTGRES_PASSWORD=postgres -d postgres
  #- docker run --net=host -v /home/runner/work/test/test/migration:/liquibase/changelog septemhill/liquibase --logLevel=debug --url=jdbc:postgresql://localhost:5432/postgres --changeLogFile=./changelog/dbchangelog.xml --username=postgres --password=postgres update

sudo: true

gobuild_args: -v

go:
  - 1.x
  - "1.14.7"
  - "1.15.1"
  - master

notifications:
  slack: obsamworkspace:CkAsaDCf4HavBESkjLhHw33W

jobs:
  include:
    - stage: Show me current path now
      script: echo $(PWD)
    - stage: Build project
      script: go build -v
    - stage: Run test cases
      script: go test $(gobuild_args) ./...
